{% extends 'base/base.html' %}

{% block page %}
<li class="breadcrumb-item"><a href="{{ url_for('index') }}">Index</a></li>
<li class="breadcrumb-item"><a href="{{ url_for('index') }}">Clientes</a></li>
<li class="breadcrumb-item"><a href="{{ url_for('listar_clientes') }}"> Listar Clientes</a></li>
<li class="breadcrumb-item active" aria-current="page">Adicionar Cliente</li>

{% endblock %}

{% block content %}

{% with messages = get_flashed_messages() %}
{% if messages %}
{% for message in messages %}
<div class="flash" id="flash">{{  message }}</div>
{% endfor %}
{% endif %}
{% endwith %}

<br>
<div class="bloco">

    <form method="post" enctype="multipart/form-data">
        {{ form.hidden_tag() }}
        <div class="card">
            <div class="card-header">
                <h4>Dados Principais</h4>
            </div>
            <br>
            <h4>Responsável pelo cliente</h4>
            <div class="form-group">
                <br>
                <div class="row">
                    <label class="control-label col-2 text-right">Nome</label>
                    <div class="col-3">
                        {{form.nome_responsavel(class="form-control")}} {{form.errors.nome_responsavel}}
                    </div>
                </div>
                <br>
            </div>

            <h4>Dados da Empresa</h4>
            <div class="row">
                <label class="control-label col-2 text-right">Empresa</label>
                <div class="col-10">
                    {{form.empresa(class="form-control")}} {{form.errors.empresa}}
                </div>
            </div>
            <br>
            <div class="row">
                <label class="control-label col-2 text-right">Natureza Jurídica</label>
                <div class="col-6">
                    {{form.natureza_juridica(class="form-control")}} {{form.errors.natureza_juridica}}
                </div>
                <label class="control-label col-1 text-right">Porte</label>
                <div class="col-3">
                    {{form.porte(class="form-control")}} {{form.errors.porte}}
                </div>
            </div>
            <br>

            <h4>Localização</h4>

            <div class="form-group">
                <div class="row">
                    <label class="control-label col-2 text-right">CEP</label>
                    <div class="col-2">
                        {{form.cep(class="cep form-control")}} {{form.errors.cep}}
                    </div>
                </div>
                <br>
                <div class="row">
                    <label class="control-label col-2 text-right">Endereço</label>
                    <div class="col-5">
                        {{form.endereco(class=" endereco form-control")}} {{form.errors.endereco}}
                    </div>

                    <label class="control-label col-1 text-right">N°</label>
                    <div class="col-1">
                        {{form.numero(class="numero form-control")}} {{form.errors.numero}}
                    </div>

                    <label class="control-label col-1 text-right">Comp.</label>
                    <div class="col-2">
                        {{form.complemento(class="complemento form-control")}} {{form.errors.complemento}}
                    </div>
                </div>
                <br>
                <div class="form-group">
                    <div class="row">
                        <label class="control-label col-2 text-right">Bairro</label>
                        <div class="col-3">
                            {{form.bairro(class="bairro form-control")}} {{form.errors.bairro}}
                        </div>

                        <label class="control-label col-1 text-right">Cidade</label>
                        <div class="col-2">
                            {{form.cidade(class="cidade form-control")}} {{form.errors.cidade}}
                        </div>

                        <label class="control-label col-1 text-right">Estado</label>
                        <div class="col-3">
                            {{form.estado(class="estado form-control")}} {{form.errors.estado}}
                        </div>
                    </div>

                </div>
            </div>

            <div class="form-group">
                <h4>Contato Direto</h4>
                <div class="row">
                    <label class="control-label col-2 text-right">Nome</label>
                    <div class="col-3">
                        {{form.nome(class="form-control")}} {{form.errors.nome}}
                    </div>
                    <label class="control-label col-2 text-right">Telefone</label>
                    <div class="col-3">
                        {{form.telefone(class="telefone form-control")}} {{form.errors.telefone}}
                    </div>
                </div>
                <br>
                <div class="form-group">
                    <div class="row">
                        <label class="control-label col-2 text-right">Email</label>
                        <div class="col-3">
                            {{form.email(class="form-control")}} {{form.errors.email}}
                        </div>
                        <label class="control-label col-2 text-right">Celular</label>
                        <div class="col-3">
                            {{form.celular(class="celular form-control")}} {{form.errors.celular}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </br>
        <div class="card">
            <div class="card-header">
                <h4>Dados Financeiros</h4>
            </div>
            <br>
            <div class="form-group">
                <div class="row">
                    <label class="control-label col-2 text-right">Capital Social</label>
                    <div class="col-4">
                        {{form.capital_social(class="capital_social form-control")}} {{form.errors.capital_social}}
                    </div>

                    <label class="control-label col-1 text-right">NIRE</label>
                    <div class="col-5">
                        {{form.nire(class="nire form-control")}} {{form.errors.nire}}
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <label class="control-label col-2 text-right">CNPJ</label>
                    <div class="col-4">
                        {{form.cnpj(class="cnpj form-control")}} {{form.errors.cnpj}}
                    </div>

                    <label class="control-label col-1 text-right">I/E</label>
                    <div class="col-4">
                        {{form.inscricao_estadual(class="inscricao_estadual form-control")}} {{form.errors.inscricao_estadual}}
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <label class="control-label col-2 text-right">CCM</label>
                    <div class="col-4">
                        {{form.ccm(class="ccm form-control")}} {{form.errors.ccm}}
                    </div>

                    <label class="control-label col-1 text-right">Tributacao</label>
                    <div class="col-4">
                        {{form.tributacao(class="form-control")}} {{form.errors.tributacao}}
                    </div>
                </div>
            </div>
            <div id="id_cnaes">
                <div class="cnaes">
                    <div class="form-group">
                        <div class="row">
                            <label class="control-label col-2 text-right">Impugnação</label>
                            <div class="col-4">
                                {{form.impugnacao(class="form-control")}} {{form.errors.impugnacao}}
                            </div>
                            <label class="control-label col-1 text-right">CNAE</label>
                            <div class="col-4">
                                <input type="text"  class="form-control cnaes_x" id="cnae"  name="cnae[]" placeholder="  Digite o CNAE"  multiple='multiple' value="" maxlength="18"/>
                            </div>
                            <div>
                            <button class="btn btn-primary" id="add_cnae" title="Adicionar CNAEs" > + </button>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <br>
            <div class="form-group">
                <div class="row">
                    <label class="control-label col-2 text-right">Dia Faturamento</label>
                    <div class="col-2">
                        {{form.dia_faturamento(class="form-control")}} {{form.errors.dia_faturamento}}
                    </div>

                    <label class="control-label col-2 text-right">Folha Pagamento</label>
                    <div class="col-2">
                        {{form.folha_pagamento(class="form-control")}} {{form.errors.folha_pagamento}}
                    </div>

                    <label class="control-label col-2 text-right">Certificado Digital</label>
                    <div class="col-2">
                        {{form.certificado_digital(class="form-control")}} {{form.errors.certificado_digital}}
                    </div>
                </div>
            </div>
        </div>
        <br>
        <h4>Observações</h4>
        <div class="form-group">
            <div class="row">
                <div class="col-6 offset-sm-2">
                    {{form.observacoes(class="form-control")}} {{form.errors. observacoes}}
                </div>
            </div>
        </div>

        <div class="form-group">
            <div class="row">
                <div class="col-9"></div>
                <div class="col-3">
                    <button class="btn btn-primary" type="button"><a href="{{ url_for('listar_clientes') }}" ><font color=white>voltar</font></a></button>
                    <button class="btn btn-primary"  type="submit">Salvar</button>
                </div>
            </div>
        </div>
    </form>
</div>

<script src="{{ url_for('static', filename='jquery-mask-plugin/src/jquery.mask.js') }}"></script>
<script src="{{ url_for('static', filename='js/scripts.js') }}"></script>

<script>


    $(document).ready(function () {
        var num = 1;

        $('#add_cnae').on('keydown', function (e) {
            if (e.keyCode == 9) {
                $(this).next().focus();
                return true;
            }

            e.preventDefault();
            if (e.keyCode == 13 || e.keyCode == 32) {
                $('#add_cnae').trigger('click');
            }
        });

        $("#add_cnae").on("click", function (e) {
            e.preventDefault();

            if (num > 6) {
                return false;
            }

            var str = '';
            str += '<div id="id_cnaes">';
            str +=     '<div class="cnaes">';
            str +=         '<div class="form-group">';
            str +=            '<div class="row">';
            str +=     '<label class="control-label col-2 text-right"></label>';
            str +=                 '<div class="col-4">';
            str +=                     '';
            str +=                 '</div>';
            str +=               '<label class="control-label col-1 text-right">CNAE</label>';
            str +=                  '<div class="col-4">';
               if (num === 1) {
                 str +=                     '<input type="text" id="cnae"  class="form-control cnaes_x" name="cnae[]"  placeholder="  Digite o CNAE 2 " />';
            }
                if (num === 2) {
                 str +=                     '<input type="text" id="cnae"  class="form-control cnaes_x" name="cnae[]"  placeholder="  Digite o CNAE 3 " />';
            }
                if (num === 3) {
                 str +=                     '<input type="text" id="cnae"  class="form-control cnaes_x" name="cnae[]"  placeholder="  Digite o CNAE 4 " />';
            }
                 if (num === 4) {
                 str +=                     '<input type="text" id="cnae"  class="form-control cnaes_x" name="cnae[]"  placeholder="  Digite o CNAE 5 " />';
            }
                    if (num === 5) {
                 str +=                     '<input type="text" id="cnae"  class="form-control cnaes_x" name="cnae[]"  placeholder="  Digite o CNAE 6 " />';
            }
                        if (num === 6) {
                 str +=                     '<input type="text" id="cnae"  class="form-control cnaes_x" name="cnae[]"  placeholder="  Digite o CNAE 7 " />';
            }
            str +=                   '</div>';

            str +=                   '<div>';
            str +=                     ' <button class="btn btn-primary deltel" title="Remover Anexo"> - </button>';
            str +=                   '</div>';
            str +=                  '</div>';
            str +=             '</div>';
            str +=          '</div>';
            str +=      '</div>';
            str += '</div>';


            var objfields = $(str);
            $('#id_cnaes').append(objfields);
            num++;
        });


        $(document).on('click', '.deltel', function(e) {
            e.preventDefault();
            $(this).parents('.cnaes').remove();
            num--;
        });
    });
</script>




{% endblock %}